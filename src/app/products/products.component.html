<h2 class="text-3xl mt-9 font-bold text-gray-900 mb-6 text-center">
  Liste des produits
</h2>

<div class="mx-auto max-w-lg bg-white p-6 rounded-2xl shadow mb-10">
  <h3 class="text-xl font-semibold mb-4 text-center">
    {{ editing ? "Modifier un produit" : "Ajouter un produit" }}
  </h3>

  <form (ngSubmit)="saveProduct()" class="space-y-4">

    <input type="text" placeholder="Nom du produit"
      [(ngModel)]="form.nom" name="nom"
      class="w-full border rounded-lg p-3" required />

    <textarea placeholder="Description"
      [(ngModel)]="form.description" name="description" required
      class="w-full border rounded-lg p-3"></textarea>

    <input type="number" placeholder="Prix"
      [(ngModel)]="form.prix" name="prix"
      class="w-full border rounded-lg p-3" required />

    <input type="number" placeholder="Stock"
      [(ngModel)]="form.stock" name="stock"
      class="w-full border rounded-lg p-3" required />

    <select placeholder="Catégorie"
      [(ngModel)]="form.categorieId" name="categorie"
      class="w-full border rounded-lg p-3" required >
      <option value="" disabled selected>Choisir une catégorie</option>
      @for(cat of categories; track cat.id){
        <option  [value]="cat.id">{{ cat.nom }}</option>
      }

    </select>


    <div class="flex justify-between">
      <button type="submit"
        class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition">
        {{ editing ? "Mettre à jour" : "Ajouter" }}
      </button>

      @if(editing){
        <button type="button"
        (click)="cancelEdit()"
        class="px-4 py-2 bg-gray-400 text-white rounded-lg hover:bg-gray-500 transition">
        Annuler
      </button>
      }

    </div>

  </form>
  <app-toast></app-toast>
</div>

<!-- LISTE DES PRODUITS -->
<ul class="grid mx-8 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 px-2">
  @for (p of products; track p.id) {
    <li class="bg-white p-5 rounded-2xl shadow hover:shadow-md transition flex flex-col justify-between border border-gray-100">

      <div>
        <h3 class="text-lg font-semibold text-gray-800 mb-2">{{ p.nom }}</h3>
        <p class="text-sm text-gray-500 mb-4">
          {{ p.description ?? 'Aucune description disponible.' }}
        </p>
      </div>

      <div class="flex justify-between items-center mt-auto">

        <span class="text-blue-600 font-bold text-xl">
          {{ p.prix }} £
        </span>

        <div class="flex gap-2">
          <button (click)="editProduct(p)"
            class="px-3 py-1 bg-yellow-500 text-white rounded-lg text-sm hover:bg-yellow-600 transition">
            <lucide-angular [img]="PenIcon" ></lucide-angular>

          </button>

          <button (click)="deleteProduct(p.id)"
            class="px-3 py-1 bg-red-600 text-white rounded-lg text-sm hover:bg-red-700 transition">
            <lucide-angular [img]="TrashIcon" ></lucide-angular>
          </button>
        </div>

      </div>

    </li>
  }
</ul>
